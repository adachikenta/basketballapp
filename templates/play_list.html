{% extends "base.html" %}
{% block title %}{{ _('play_diagram_list') }}{% endblock %}
{% block extra_head %}
<style>
    .play-list-container {
        max-width: 1200px;
        margin: 0 auto;
    }
    
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 15px;
        border-bottom: 2px solid #0da12e;
    }
    
    .page-header h1 {
        margin: 0;
        color: #0da12e;
    }
    
    .create-button {
        padding: 10px 20px;
        background-color: #0da12e;
        color: #ffffff;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        transition: background-color 0.3s;
    }
    
    .create-button:hover {
        background-color: #0a8024;
        opacity: 1;
    }
    
    .play-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .play-card {
        background-color: #ffffff;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s, box-shadow 0.2s;
        cursor: pointer;
    }
    
    .play-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .play-card h3 {
        margin: 0 0 10px 0;
        color: #0da12e;
        font-size: 1.2em;
    }
    
    .play-card .description {
        color: #666;
        font-size: 0.9em;
        margin-bottom: 15px;
        min-height: 60px;
    }
    
    .play-card .metadata {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.85em;
        color: #999;
        margin-bottom: 15px;
        padding-top: 10px;
        border-top: 1px solid #eee;
    }
    
    .play-card .actions {
        display: flex;
        gap: 10px;
    }
    
    .play-card .btn-small {
        padding: 6px 12px;
        font-size: 0.85em;
        border-radius: 4px;
        border: none;
        cursor: pointer;
        transition: background-color 0.2s;
    }
    
    .btn-edit {
        background-color: #0da12e;
        color: #ffffff;
    }
    
    .btn-edit:hover {
        background-color: #0a8024;
    }
    
    .btn-delete {
        background-color: #dc3545;
        color: #ffffff;
    }
    
    .btn-delete:hover {
        background-color: #c82333;
    }
    
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        background-color: #f8f9fa;
        border-radius: 8px;
        margin-top: 30px;
    }
    
    .empty-state h3 {
        color: #666;
        margin-bottom: 15px;
    }
    
    .empty-state p {
        color: #999;
        margin-bottom: 25px;
    }
</style>
{% endblock %}
{% block content %}
<div class="play-list-container">
    <div class="page-header">
        <h1>ğŸ€ ç± çƒå›³ä¸€è¦§</h1>
        <a href="/play/new" class="create-button">â• æ–°è¦ä½œæˆ</a>
    </div>
    
    {% if plays and plays|length > 0 %}
        <div class="play-grid">
            {% for play in plays %}
            <div class="play-card" onclick="window.location.href='/play/edit?id={{ play.id }}'">
                <h3>{{ play.name }}</h3>
                <div class="description">
                    {{ play.description or 'èª¬æ˜ãªã—' }}
                </div>
                <div class="metadata">
                    <span>ä½œæˆè€…: {{ play.user.username }}</span>
                    <span>{{ play.created_at.strftime('%Y-%m-%d') }}</span>
                </div>
                <div class="actions" onclick="event.stopPropagation()">
                    <button class="btn-small btn-edit" onclick="window.location.href='/play/edit?id={{ play.id }}'">
                        âœï¸ ç·¨é›†
                    </button>
                    <button class="btn-small btn-delete" onclick="deletePlay({{ play.id }})">
                        ğŸ—‘ï¸ å‰Šé™¤
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <h3>ç± çƒå›³ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“</h3>
            <p>ã€Œæ–°è¦ä½œæˆã€ãƒœã‚¿ãƒ³ã‹ã‚‰æœ€åˆã®ç± çƒå›³ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†</p>
            <a href="/play/new" class="create-button">â• ç± çƒå›³ã‚’ä½œæˆã™ã‚‹</a>
        </div>
    {% endif %}
</div>
<script>
function deletePlay(playId) {
    if (confirm('ã“ã®ç± çƒå›³ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
        fetch(`/api/play/delete/${playId}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                alert('å‰Šé™¤ã—ã¾ã—ãŸ');
                location.reload();
            } else {
                alert('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ');
        });
    }
}
</script>
{% endblock %}
